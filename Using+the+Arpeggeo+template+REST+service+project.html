<html manifest="pamflet.manifest">
      <head>
        <title>Arpeggeo — Using the Arpeggeo template REST service project</title>
        <link type="text/css" media="screen, projection" rel="stylesheet" href="css/blueprint/screen.css"></link>
        <link type="text/css" media="screen and (min-device-width: 800px), projection" rel="stylesheet" href="css/blueprint/grid.css"></link>
        <link type="text/css" media="print" rel="stylesheet" href="css/blueprint/print.css"></link> 
        <!--[if lt IE 8]>
          <link rel="stylesheet" href="css/blueprint/ie.css" type="text/css" media="screen, projection"/>
        <![endif]-->
        <link type="text/css" media="screen, projection" rel="stylesheet" href="css/pamflet.css"></link>
        <link type="text/css" media="print" rel="stylesheet" href="css/pamflet-print.css"></link>
        <link type="text/css" media="screen and (min-device-width: 800px), projection" rel="stylesheet" href="css/pamflet-grid.css"></link>
        <link type="text/css" media="screen, projection" rel="stylesheet" href="css/custom.css"></link>
        <script src="js/jquery-1.6.2.min.js"></script>
        <script src="js/pamflet.js"></script>
        <script type="text/javascript" src="js/prettify/prettify.js"></script><link type="text/css" rel="stylesheet" href="css/prettify.css"></link><script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
        <meta charset="utf-8"></meta>
        <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
      </head>
      <body>
        <a class="page prev nav" href="Setting+up+Arpeggeo.html">
            <span class="space">&nbsp;</span>
            <span class="flip">❧</span>
          </a><a class="page next nav" href="Contents+in+Depth.html">
            <span class="space">&nbsp;</span>
            <span>❧</span>
          </a>
        <div class="container">
          <div class="span-16 prepend-1 append-1">
            <div class="top nav span-16 title">
              <span>Arpeggeo</span>
               — Using the Arpeggeo template REST service project
            </div>
          </div>
          <div class="span-16 prepend-1 append-1 contents">
            <h2 id="Using+the+Arpeggeo+template+REST+service+project">Using the Arpeggeo template REST service project</h2><p>The template REST service project provides a template for creating a 
geoprocessing web service with Arpeggeo.  It’s an initial project that is a blank 
slate for your own 
development by providing a development environment that is set up
with the necessary dependencies in place.  The project loads Arpeggeo as a
library, includes some basic configuration, and has a very simple “hello world” 
web service in place for you 
to edit.
</p><p>If you are a first time user, you may want to use the template along with the tutorial
included in this documentation to start exploring how to build your own geoprocessing service.
</p><h2 id="Step+1%3A+Run+SBT">Step 1: Run SBT</h2><p>This project uses SBT, Simple Build Tool, for compilation and execution.
</p><p>If you don’t have SBT installed already, you can run a script in the template
directory (from https://github.com/paulp/sbt-extras) that will automatically download it for you.
</p><p>At the command line, go to the directory where you’ve installed this template
and run ”./sbt”.  For example:
</p><pre><code class="prettyprint lang-bash">git clone xxxx
cd arpegeo-template
./sbt
</code></pre><p>The first time you run SBT, there will be a significant delay as all of the
necessary libraries are downloaded.
</p><p>If you get any sort of error that a library can’t be downloaded, please let us 
know so we can fix the problem.  SBT downloads the libraries from where they
are hosted on the internet, so problems can arise when repositories change.  
<br/>
When sbt is done loading and compiling, you’ll see an sbt prompt:
</p><pre><code class="prettyprint lang-"> &gt;
</code></pre><p>If you type <code>`run</code><code>, you'll see some messages from Jetty, the embedded webserver that responds to Arpeggeo requests. 
</code><code>
 &gt; run
[info] Starting server on port 8888.
[error] 2012-02-06 14:17:08.255:INFO:oejs.Server:jetty-8.1.0.RC4
[error] 2012-02-06 14:17:08.329:INFO:oejs.AbstractConnector:Started SelectChannelConnector@0.0.0.0:8888 STARTING
</code>`
</p><p>This means that you are now running a webserver on port 8888 that responds to
requests.  Go to 
</p><p>http://localhost:8888/template
</p><p>to see the template web service, which just shows HTML of “Hello Trellis!”
</p><h2 id="Step+2%3A+Edit+the+configuration+file">Step 2: Edit the configuration file</h2><p>There’s a configuration file you can edit at src/main/resources/application.conf.  For example, some settings include:
</p><p>What ip address should the server be listening to?
</p><pre><code class="">trellis.host = &quot;0.0.0.0&quot; // IP address to which the server will listen
                         // (0.0.0.0 means listen to all ports)
trellis.port = 8888      // The server port 
trellis.rest-package = &quot;trellis.rest&quot; // The package that will be searched for
                                      // for rest services
trellis.tmp = &quot;/tmp&quot;     // A temporary directory to be used for scratch files
</code></pre><h2 id="Step+3%3A+Import+data">Step 3: Import data</h2><p>There is a script in the /scripts directory that you can use to convert raster data in
GeoTiff format to the ARG32 format.  It assumes that you are using a Unix shell (Linux/Mac) and have installed “wget”.
</p><p>For example, to convert <code>`your_geotiff.tif</code><code> to </code><code>output.arg32</code>`, change to the
directory you’ve checked out the template and run:
</p><pre><code class="prettyprint lang-bash">scripts/trellis_import_geotiff your_geotiff.tif output.arg32
</code></pre><p>The first time you run the script it will download the necessary Trellis libraries to your
system.
</p><h2 id="Step+4%3A+Edit+the+catalog.json+file">Step 4: Edit the catalog.json file</h2><p>The catalog.json file (in src/main/resources) defines the data sources that are
available to the Arpeggeo service.  You can move it to an alternate location if you
define the file path in the configuration file.
</p><h2 id="Step+5%3A+Create+your+service%21">Step 5: Create your service!</h2><p>The blank REST service is in the file src/main/scala/trellis/rest/TemplateResource.scala.  Edit that file to change the existing service, or create a similar 
class in the “trellis.rest” package to create a new service.
</p><p>If you are using the ScalaIDE for Eclipse (http://scala-ide.org/), you should
type <code>`eclipse</code>` at the sbt prompt, and then import the project into Eclipse.
(If you are using emacs, you should consider using ENSIME: https://github.com/aemoncannon/ensime.)  
</p><h2 id="Additional+notes">Additional notes</h2><h3 id="Triggered+Restart">Triggered Restart</h3><p>Note: If you run … 
</p><p> &gt; ~re-start
</p><p>… at the sbt prompt, you will be in a ‘triggered restart’ mode.  As soon
as you edit your source files, the application will re-compile and restart 
with your updated code. 
</p><h4>Contents</h4><div><a href="Arpeggeo.html">Arpeggeo</a></div><ol class="toc"> <li><div><a href="API+Reference.html">API Reference</a></div></li><li><div><a href="Operations.html">Operations</a></div></li><li><div><a href="Setting+up+Arpeggeo.html">Setting up Arpeggeo</a></div></li><li><div class="current">Using the Arpeggeo template REST service project</div></li><li class="generated"><div><a href="Contents+in+Depth.html">Contents in Depth</a></div></li><li class="generated"><div><a href="Combined+Pages.html">Combined Pages</a></div></li> </ol>
          </div>
        </div>
        <a class="fork nav" href="http://github.com/azavea/trellis"><img alt="Fork me on GitHub" src="img/fork.png"></img></a>
      </body>
    </html>